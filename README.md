Repository generated by [typedef](https://github.com/exanubes/typedef)

# typedef.nvim

A Neovim plugin that converts JSON data into type definitions for multiple programming languages.

## Features

- **Interactive Side Panel UI** - Visual interface for selecting output formats and actions
- **Multiple Output Formats** - Generate types for Go, TypeScript, Zod schemas, and JSDoc
- **Automatic Binary Installation** - Downloads and manages the typedef RPC server automatically
- **Flexible Output** - Insert generated code at cursor or copy to clipboard
- **Asynchronous** - Non-blocking RPC communication with the backend server over stdin/out

## Requirements

- **Neovim 0.7+**
- **System tools**: `curl`, `tar` (required for automatic binary installation)
- **Supported platforms**:
  - Linux (amd64, arm64)
  - macOS (amd64, arm64)

## Installation

### Using [lazy.nvim](https://github.com/folke/lazy.nvim)

```lua
{
    'exanubes/typedef',
    config = function()
        require('typedef').setup()
    end,
}
```

### Using [packer.nvim](https://github.com/wbthomason/packer.nvim)

```lua
use {
    'exanubes/typedef',
    config = function()
        require('typedef').setup()
    end,
}
```

The typedef RPC server binary will be automatically downloaded to `~/.local/share/nvim/typedef/typedef-rpc` on first use and every update from [github releases](https://github.com/exanubes/typedef/releases).

## Usage

### TypedefPanel Command

The `:TypedefPanel` command opens an interactive side panel for generating type definitions.

**Workflow:**

1. **Copy JSON to clipboard** - Copy any JSON data to your system clipboard

   Example JSON:
   ```json
   {
     "name": "John Doe",
     "age": 30,
     "email": "john@example.com",
     "active": true,
     "tags": ["developer", "opensource"]
   }
   ```

2. **Open the panel** - Run `:TypedefPanel` in Neovim

3. **Select output format** - Choose from:
   - Go
   - TypeScript
   - Zod (TypeScript Zod schemas)
   - JSDoc

4. **Choose action**:
   - **[Insert]** - Insert generated code at cursor position
   - **[Copy to clipboard]** - Copy generated code to system clipboard
   - **[Exit]** - Close the panel

**Panel Keybindings:**
- `q` - Close the panel
- `<CR>` (Enter) - Select the highlighted option
- Arrow keys or `j`/`k` - Navigate options

### Example Output

For the JSON example above, here's what each format generates:

**Go:**
```go
type Root struct {
    Name   string   
    Age    int      
    Email  string   
    Active bool     
    Tags   []string 
}
```

**TypeScript:**
```typescript
interface Root {
    name: string;
    age: number;
    email: string;
    active: boolean;
    tags: string[];
}
```

**Zod:**
```typescript
import { z } from 'zod';

const RootSchema = z.object({
    name: z.string(),
    age: z.number(),
    email: z.string(),
    active: z.boolean(),
    tags: z.array(z.string()),
});
```

**JSDoc:**
```javascript
/**
 * @typedef {Object} Root
 * @property {string} name
 * @property {number} age
 * @property {string} email
 * @property {boolean} active
 * @property {string[]} tags
 */
```

## Configuration

### Setup Options

Tie the plugin to a binary explicitely and skip the automated downloads

```lua
require('typedef').setup({
    -- Optional: specify custom path to the RPC server binary
    -- If not provided, the binary will be auto-downloaded to ~/.local/share/nvim/typedef/typedef-rpc
    rpc_server_binary = '/custom/path/to/typedef-rpc',
})
```

### Custom Keymapping

Create a keymap to quickly open the TypedefPanel:

**Lua:**
```lua
vim.keymap.set('n', '<leader>td', '<Cmd>TypedefPanel<CR>', { desc = 'Open Typedef panel' })
```

Add this to your Neovim configuration to trigger the panel with `<leader>td`.

## Troubleshooting

### Binary Installation Issues

If the automatic installation fails:

1. Ensure you have `curl` and `tar` installed
2. Check your internet connection
3. Verify your platform is supported (Linux or macOS, amd64 or arm64)
4. Check Neovim messages with `:messages` to check for errors

### RPC Connection Errors

If you see RPC-related errors:

1. Verify the binary exists at `~/.local/share/nvim/typedef/typedef-rpc`
2. Check the binary is executable: `chmod +x ~/.local/share/nvim/typedef/typedef-rpc`
3. Check versions of the plugin and rpc match
    - `~/.local/share/nvim/typedef/typedef-rpc version`
    - `typedef.nvim/lua/typedef/env.lua`
4. Try restarting Neovim to reset the RPC connection

## License

MIT License - see LICENSE file for details
